[gd_scene load_steps=10 format=3 uid="uid://bya5kq2qlfx0m"]

[ext_resource type="Terrain3DAssets" uid="uid://dal3jhw6241qg" path="res://demo/data/assets.tres" id="1_md68i"]
[ext_resource type="PackedScene" uid="uid://cx2rpesjr050y" path="res://Scenes/rat.tscn" id="2_iixdh"]
[ext_resource type="Script" path="res://Scripts/swarm_manager.gd" id="3_qldgr"]
[ext_resource type="PackedScene" uid="uid://dko2mapcxs0y3" path="res://Scenes/Player/Player.tscn" id="5_q0mm3"]

[sub_resource type="NavigationMesh" id="NavigationMesh_j3r6d"]
vertices = PackedVector3Array(36.036, 3.003, -285.285, 24.024, 3.003, -285.285, 15.015, 3.003, -273.273, -39.039, 3.003, -123.123, -33.033, 3.003, -114.114, -15.015, 3.003, -114.114, -39.039, 3.003, -141.141, -51.051, 3.003, -219.219, -60.06, 3.003, -213.213, -60.06, 3.003, -195.195, -45.045, 3.003, -171.171, -48.048, 3.003, -150.15, 234.234, 3.003, -21.021, 249.249, 3.003, -30.03, 249.249, 3.003, -48.048, -6.006, 3.003, -105.105, -15.015, 3.003, -249.249, 183.183, 3.003, -264.264, 165.165, 3.003, -270.27, 147.147, 3.003, -267.267, 282.282, 3.003, -183.183, 3.003, 3.003, -273.273, 183.183, 3.003, 9.009, 216.216, 3.003, 15.015, 225.225, 3.003, 9.009, 72.072, 3.003, 18.018, 102.102, 3.003, 18.018, 108.108, 3.003, -3.003, 18.018, 3.003, 6.006, -48.048, 3.003, -243.243, 114.114, 3.003, -6.006, 135.135, 3.003, 27.027, -27.027, 3.003, -9.009, -18.018, 3.003, 0, 159.159, 3.003, 27.027, 264.264, 3.003, -60.06, 276.276, 3.003, -96.096, 87.087, 3.003, -315.315, 60.06, 3.003, -318.318, 240.24, 3.003, -282.282, 216.216, 3.003, -282.282, 306.306, 3.003, -123.123, 300.3, 3.003, -174.174)
polygons = [PackedInt32Array(2, 1, 0), PackedInt32Array(4, 3, 5), PackedInt32Array(5, 3, 6), PackedInt32Array(8, 7, 9), PackedInt32Array(9, 7, 10), PackedInt32Array(6, 11, 10), PackedInt32Array(14, 13, 12), PackedInt32Array(6, 10, 15), PackedInt32Array(15, 10, 7), PackedInt32Array(15, 7, 16), PackedInt32Array(15, 16, 0), PackedInt32Array(18, 17, 19), PackedInt32Array(19, 17, 20), PackedInt32Array(16, 21, 2), PackedInt32Array(23, 22, 24), PackedInt32Array(24, 22, 12), PackedInt32Array(26, 25, 27), PackedInt32Array(27, 25, 28), PackedInt32Array(7, 29, 16), PackedInt32Array(31, 30, 22), PackedInt32Array(22, 30, 12), PackedInt32Array(12, 30, 14), PackedInt32Array(33, 32, 28), PackedInt32Array(28, 32, 15), PackedInt32Array(28, 15, 27), PackedInt32Array(27, 15, 30), PackedInt32Array(15, 5, 6), PackedInt32Array(22, 34, 31), PackedInt32Array(35, 14, 36), PackedInt32Array(36, 14, 20), PackedInt32Array(38, 37, 0), PackedInt32Array(0, 37, 19), PackedInt32Array(40, 39, 17), PackedInt32Array(17, 39, 20), PackedInt32Array(0, 19, 15), PackedInt32Array(15, 19, 30), PackedInt32Array(30, 19, 14), PackedInt32Array(14, 19, 20), PackedInt32Array(16, 2, 0), PackedInt32Array(42, 41, 20), PackedInt32Array(20, 41, 36)]
cell_size = 3.0
cell_height = 3.0
agent_height = 3.0
agent_radius = 3.0
agent_max_climb = 0.5
agent_max_slope = 60.15

[sub_resource type="Gradient" id="Gradient_e6lj2"]
offsets = PackedFloat32Array(0.2, 1)
colors = PackedColorArray(1, 1, 1, 1, 0, 0, 0, 1)

[sub_resource type="FastNoiseLite" id="FastNoiseLite_c7s6e"]
noise_type = 2
frequency = 0.03
cellular_jitter = 3.0
cellular_return_type = 0
domain_warp_enabled = true
domain_warp_type = 1
domain_warp_amplitude = 50.0
domain_warp_fractal_type = 2
domain_warp_fractal_lacunarity = 1.5
domain_warp_fractal_gain = 1.0

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_wijl4"]
seamless = true
color_ramp = SubResource("Gradient_e6lj2")
noise = SubResource("FastNoiseLite_c7s6e")

[sub_resource type="Terrain3DMaterial" id="Terrain3DMaterial_e0an3"]
_shader_parameters = {
&"bias_distance": 512.0,
&"blend_sharpness": 0.5,
&"depth_blur": 0.0,
&"enable_macro_variation": true,
&"enable_projection": true,
&"flat_terrain_normals": false,
&"macro_variation1": Color(1, 1, 1, 1),
&"macro_variation2": Color(1, 1, 1, 1),
&"macro_variation_slope": 0.333,
&"mipmap_bias": 1.0,
&"noise1_angle": 0.0,
&"noise1_offset": Vector2(0.5, 0.5),
&"noise1_scale": 0.04,
&"noise2_scale": 0.076,
&"noise_texture": SubResource("NoiseTexture2D_wijl4"),
&"projection_threshold": 0.8
}

[node name="map" type="Node3D"]

[node name="Marker3D" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 29, 5, -40)

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_j3r6d")
navigation_layers = 2

[node name="Terrain3D" type="Terrain3D" parent="NavigationRegion3D"]
data_directory = "res://"
material = SubResource("Terrain3DMaterial_e0an3")
assets = ExtResource("1_md68i")
collision_mode = 3
collision_layer = 2
collision_mask = 0
top_level = true
metadata/_edit_lock_ = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]

[node name="swarm_manager" type="Node3D" parent="."]
script = ExtResource("3_qldgr")

[node name="rat" parent="swarm_manager" node_paths=PackedStringArray("end_patrol_position") instance=ExtResource("2_iixdh")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 9.36298, 6, -2.65225)
end_patrol_position = NodePath("../../Marker3D")

[node name="rat2" parent="swarm_manager" node_paths=PackedStringArray("end_patrol_position") instance=ExtResource("2_iixdh")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 16.5221, 6, -1.94481)
end_patrol_position = NodePath("../../Marker3D")

[node name="Player" parent="." instance=ExtResource("5_q0mm3")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 72.4673, 3.86652, -9.04273)

[connection signal="killed" from="swarm_manager/rat" to="swarm_manager" method="_on_rat_killed"]
[connection signal="killed" from="swarm_manager/rat2" to="swarm_manager" method="_on_rat_killed"]
